{# Copyright The IETF Trust 2015, All Rights Reserved #}

{% extends "base.html" %}
{% load origin %}
{% load cache %}

{% block title %}Release information{% endblock title %}

{% block content %}
    {% origin %}
    <div class="row">
        <h1 class="col-11">
            <a href="https://trac.ietf.org/trac/ietfdb/browser/tags/{{ entry.version }}">
                Version {{ entry.version }}</a>
            <br/><small>Released {{ entry.date }}</small>
        </h1>
        <div class="col-1 text-end">
            <a href="{% url "ietf.release.views.stats" %}" class="icon-link">
                <span class="bi bi-bar-chart-line"></span>
            </a>
        </div>
    </div>

    <ul class="pagination d-flex py-2">
        <li class="me-auto page-item {% if not entry.prev %}disabled{% endif %}">
            <a class="page-link" href="{% if entry.prev %}/release/{{ entry.prev.version }}/{% else %}#{% endif %}"><span class="bi bi-arrow-left"></span> Previous release</a>
        </li>
        <li class="page-item {% if not entry.next %}disabled{% endif %}">
            <a class="page-link" href="{% if entry.next %}/release/{{ entry.next.version }}/{% else %}#{% endif %}">Next release <span class="bi bi-arrow-right"></span></a>
        </li>
    </ul>

    <p>
        {% if coverage %}
            Tested:
            <b>Code</b>: {{ coverage.code.percentage|stringformat:".2f" }}%,
            <b>Templates</b>: {{ coverage.template.percentage|stringformat:".2f" }}%,
            <b>URLs</b>: {{ coverage.url.percentage|stringformat:".2f" }}%
        {% endif %}
        {% if code_coverage_url %}
            <br/>
            (A <a href="{{ code_coverage_url }}">code test coverage report</a> dated {{ code_coverage_time }} is available.)
        {% endif %}
    </p>

    <h2>{{ entry.version }} release notes</h2>
    {% if entry.title %}<h4>{{ entry.title }}</h4>{% endif %}
    <pre>{{ entry.html|safe }}

  &mdash; {{ entry.author }} &lt;{{ entry.email }}&gt;  {{ entry.date }}
    </pre>

    {% cache 3600 ietf_release_list %}
        <div id="release-list"></div>
        <h2>Release list:</h2>

        <table class="table table-striped table-sm">
            {% for item in releases %}
                {% ifchanged %}
                    <tr class="table-info">
                        <th colspan="3" class="h4">{{ item.date|slice:"7:11" }}</th>
                    </tr>
                {% endifchanged %}
                <tr>
                    <td class="text-end"><a href="/release/{{ item.version }}/">{{ item.version }}</a></td>
                    <td class="text-end pe-3">{{ item.date|slice:":11" }}</td>
                    <td>{{ item.title }}</td>
                </tr>
            {% endfor %}
        </table>
    {% endcache %}

{% endblock content %}

{% block footer %}
    <p class="text-center">
        <a href="https://trac.ietf.org/trac/ietfdb/wiki/ContractorInstructions">Contractor instructions</a>
    </p>
    {{ block.super }}
{% endblock footer %}